<!DOCTYPE html>
<html>
<head>
    <title>Mapy.cz Panorama REST API Test</title>
    <meta charset="utf-8">
</head>
<body>
    <h1>Mapy.cz Panorama REST API Test</h1>
    
    <h2>Test Static Panorama Endpoint:</h2>
    <p>This tests if panorama exists by trying to load a static panorama image.</p>
    
    <button onclick="testStaticPanorama(14.4378, 50.0755, 'Prague Center')">Test Prague Center</button>
    <button onclick="testStaticPanorama(14.4000, 50.0907, 'Prague Castle')">Test Prague Castle</button>
    <button onclick="testStaticPanorama(16.6068, 49.1951, 'Brno Center')">Test Brno Center</button>
    
    <h2>Results:</h2>
    <div id="result" style="border: 1px solid #ccc; padding: 10px; margin-top: 10px;">
        Click a button to test...
    </div>
    
    <h2>Panorama Image (if available):</h2>
    <div id="image-container" style="margin-top: 10px;">
    </div>

    <script>
        const API_KEY = 'eyJpIjoyNTcsImMiOjE2Njc0ODU2MjN9.c_UlvdpHGTI_Jb-TNMYlDYuIkCLJaUpi911RdlwPsAY';
        
        function testStaticPanorama(lon, lat, locationName) {
            const resultDiv = document.getElementById('result');
            const imageContainer = document.getElementById('image-container');
            
            resultDiv.innerHTML = `<strong>Testing ${locationName}...</strong><br>`;
            imageContainer.innerHTML = '';
            
            // Build static panorama URL
            const panoramaUrl = `https://api.mapy.cz/v1/static/pano?width=600&height=400&lon=${lon}&lat=${lat}&yaw=0&apikey=${API_KEY}`;
            
            resultDiv.innerHTML += `URL: ${panoramaUrl}<br><br>`;
            
            // Create image element
            const img = new Image();
            
            img.onload = function() {
                resultDiv.innerHTML += '<strong style="color: green;">✓ Panorama exists at this location!</strong>';
                imageContainer.innerHTML = `<img src="${panoramaUrl}" style="max-width: 100%; border: 2px solid green;">`;
            };
            
            img.onerror = function() {
                resultDiv.innerHTML += '<strong style="color: red;">✗ No panorama at this location (or API error)</strong>';
                
                // Try to fetch to get more error details
                fetch(panoramaUrl)
                    .then(response => {
                        resultDiv.innerHTML += `<br>HTTP Status: ${response.status}`;
                        return response.text();
                    })
                    .then(text => {
                        if (text.length < 1000) { // Only show if it's likely an error message
                            resultDiv.innerHTML += `<br>Response: ${text}`;
                        }
                    })
                    .catch(error => {
                        resultDiv.innerHTML += `<br>Fetch error: ${error.message}`;
                    });
            };
            
            // Start loading
            img.src = panoramaUrl;
        }
        
        // Also test with fetch API
        async function testWithFetch(lon, lat) {
            const url = `https://api.mapy.cz/v1/static/pano?width=100&height=100&lon=${lon}&lat=${lat}&yaw=0&apikey=${API_KEY}`;
            
            try {
                const response = await fetch(url, {
                    method: 'HEAD' // Just check if resource exists
                });
                
                console.log('Fetch response:', {
                    status: response.status,
                    ok: response.ok,
                    headers: Object.fromEntries(response.headers.entries())
                });
                
                return response.ok;
            } catch (error) {
                console.error('Fetch error:', error);
                return false;
            }
        }
    </script>
</body>
</html>